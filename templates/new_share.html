<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Create New Share</title>
  <style>
    :root {
      --bg: #121212;
      --fg: #e0e0e0;
      --accent: #1db954;
      --input-bg: #1f1f1f;
      --input-border: #333;
      --button-hover: #1ed760;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--fg);
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }
    form {
      background: #1e1e1e;
      padding: 2rem;
      border-radius: 8px;
      width: 100%;
      max-width: 400px;
    }
    h1 {
      margin-top: 0;
      text-align: center;
      color: var(--accent);
    }
    .field {
      margin-bottom: 1.2rem;
    }
    label {
      display: block;
      margin-bottom: .4rem;
      font-size: .9rem;
    }
    input, select {
      width: 100%;
      padding: .8rem;
      background: var(--input-bg);
      border: 1px solid var(--input-border);
      border-radius: 4px;
      color: var(--fg);
      font-size: 1rem;
    }
    small {
      display: block;
      margin-top: .2rem;
      color: #888;
    }
    button {
      width: 100%;
      padding: .9rem;
      font-size: 1.1rem;
      border: none;
      border-radius: 6px;
      background: var(--accent);
      color: #000;
      font-weight: bold;
      cursor: pointer;
      transition: background .2s ease;
    }
    button:hover {
      background: var(--button-hover);
    }
    .hidden { display: none; }
  </style>
</head>
<body>
  <form action="/shares/new" method="post">
    <h1>New Share</h1>

    <div class="field">
      <label for="source">Source</label>
      <select name="source" id="source" required>
        <option value="">— select —</option>
        <option value="jellyfin">Jellyfin</option>
        <option value="stash">Stash</option>
      </select>
    </div>

    <div class="field" id="field-item_id">
      <label for="item_id">Jellyfin Item ID</label>
      <input type="text" id="item_id" name="item_id" placeholder="e.g. abc123">
    </div>

    <div class="field hidden" id="field-scene_id">
      <label for="scene_id">Stash Scene ID</label>
      <input type="text" id="scene_id" name="scene_id" placeholder="e.g. 987xyz">
    </div>

    <div class="field">
      <label for="name">Share Name</label>
      <input type="text" id="name" name="name" required placeholder="Friendly name">
    </div>

    <div class="field">
      <label for="expiration">Expires At</label>
      <input type="datetime-local" id="expiration" name="expiration">
      <small>Leave blank → 7 days from now</small>
    </div>

    <div class="field">
      <label for="max_views">Max Views</label>
      <input type="text" id="max_views" name="max_views" placeholder="Leave blank for unlimited">
    </div>

    <div class="field">
      <label for="allowed_ips">Allowed IPs</label>
      <input type="text" id="allowed_ips" name="allowed_ips" placeholder="1.2.3.4, 10.0.0.0/8">
      <small>Comma‑separated; blank allows all</small>
    </div>

    <button type="submit">Create Share</button>
  </form>

  <script>
    const src = document.querySelector("#source");
    const fJ  = document.querySelector("#field-item_id");
    const fS  = document.querySelector("#field-scene_id");
    function toggleFields(){
      if(src.value === "jellyfin"){
        fJ.classList.remove("hidden");
        fS.classList.add("hidden");
      } else if(src.value === "stash"){
        fS.classList.remove("hidden");
        fJ.classList.add("hidden");
      } else {
        fJ.classList.add("hidden");
        fS.classList.add("hidden");
      }
    }
    src.addEventListener("change", toggleFields);
    window.addEventListener("DOMContentLoaded", toggleFields);
  </script>
</body>
</html>
